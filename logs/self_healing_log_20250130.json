{
  "timestamp": "2025-01-30T12:45:23.456Z",
  "healing_session_id": "heal_3145_demo",
  "trigger": "memory_sync_failure",
  "initial_state": {
    "service": "memory_backend",
    "status": "degraded",
    "error": "Connection pool exhausted",
    "affected_endpoints": [
      "/api/v1/memory/search",
      "/api/v1/memory/create"
    ],
    "error_rate": 0.15,
    "response_time_ms": 2500
  },
  "diagnosis": {
    "root_cause": "Database connection leak in vector search",
    "impact_level": "moderate",
    "affected_users": 127,
    "diagnosis_time_ms": 342
  },
  "repair_actions": [
    {
      "action": "restart_connection_pool",
      "timestamp": "2025-01-30T12:45:24.123Z",
      "status": "success",
      "details": {
        "connections_closed": 48,
        "connections_created": 20,
        "pool_size": 20
      }
    },
    {
      "action": "patch_memory_service",
      "timestamp": "2025-01-30T12:45:25.456Z",
      "status": "success",
      "details": {
        "patch_applied": "close_connection_after_search",
        "code_modified": "/apps/backend/memory/backend_memory_store.py",
        "lines_changed": 3
      }
    },
    {
      "action": "restart_affected_workers",
      "timestamp": "2025-01-30T12:45:26.789Z",
      "status": "success",
      "details": {
        "workers_restarted": 4,
        "graceful_shutdown": true,
        "requests_preserved": 15
      }
    }
  ],
  "validation": {
    "post_repair_checks": [
      {
        "check": "endpoint_health",
        "status": "passed",
        "response_time_ms": 45,
        "error_rate": 0.0
      },
      {
        "check": "connection_pool_status",
        "status": "passed",
        "active_connections": 12,
        "idle_connections": 8
      },
      {
        "check": "memory_search_test",
        "status": "passed",
        "search_time_ms": 38,
        "results_returned": 10
      }
    ],
    "recovery_time_ms": 3567,
    "validation_status": "all_passed"
  },
  "outcome": {
    "status": "healed",
    "service_restored": "2025-01-30T12:45:27.023Z",
    "downtime_prevented_minutes": 12,
    "automated_resolution": true,
    "human_intervention_required": false
  },
  "metrics": {
    "mean_time_to_detect_ms": 234,
    "mean_time_to_repair_ms": 3567,
    "success_rate": 1.0,
    "prevented_errors": 1523,
    "performance_improvement": 0.98
  },
  "learning": {
    "pattern_identified": "connection_leak_after_vector_search",
    "prevention_rule_created": true,
    "rule_id": "rule_conn_leak_vector_2025013",
    "similar_issues_prevented": 3
  },
  "audit_trail": {
    "triggered_by": "claude_repair_agent",
    "approved_by": "auto_approval_policy",
    "notifications_sent": [
      {
        "channel": "slack",
        "recipient": "#brainops-alerts",
        "status": "delivered"
      },
      {
        "channel": "email",
        "recipient": "ops@myroofgenius.com",
        "status": "delivered"
      }
    ],
    "logged_to": [
      "papertrail",
      "supabase_audit_log",
      "local_jsonl"
    ]
  }
}